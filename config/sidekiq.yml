<% require_relative '../app/lib/trade_tariff_backend' %>

:verbose: false
:concurrency: 10
:queues:
  - healthcheck
  - rollbacks
  - sync
  - default
:schedule:
  #
  # Syntax:
  #
  # mm hh dd mt wd  command
  #
  # mm minute 0-59
  # hh hour 0-23
  # dd day of month 1-31
  # mt month 1-12
  # wd day of week 0-7 (Sunday = 0 or 7)
  #
  # Online converter: https://crontab.guru/#0_22_*_*_*
  #
  PopulateChangesTableWorker:
    cron: "30 4 * * *"
    description: "Populates the changes table"
  PopulateSearchSuggestionsWorker:
    cron: "0 18 * * *"
    description: "Populates search suggestions which are used in the frontend"
  UKUpdatesSynchronizerWorker:
    cron: "0 5 * * *"
    description: "Runs ETL of CDS files and populates indexes"
    class: UpdatesSynchronizerWorker
    status: <%= TradeTariffBackend.uk? ? 'enabled' : 'disabled' %>
  XIUpdatesSynchronizerWorker:
    cron: "0 0 * * *"
    description: "Runs ETL of Taric files and populates indexes"
    class: UpdatesSynchronizerWorker
    status: <%= TradeTariffBackend.xi? ? 'enabled' : 'disabled' %>
  HealthcheckWorker:
    every: 30.minutes
    description: Trigger the health check
  UKSpellingFileUploaderWorker:
    cron: "0 14 * * *"
    description: "Uploads a new snapshot of the spelling model based on the latest data."
    class: SpellingFileUploaderWorker
    status: <%= TradeTariffBackend.uk? ? 'enabled' : 'disabled' %>
